{
    "swagger": "2.0",
    "info": {
        "title": "Marketing Api",
        "version": "1.0.0"
    },
    "host": "api5.audi.dev.agence-one.net",
    "basePath": "/marketing/dev/",
    "schemes": [
        "http"
    ],
    "produces": [
        "application/json"
    ],
    "paths": {
        "/offer/partner/{partnerId}": {
            "get": {
                "tags": [
                    "offer"
                ],
                "summary": "Get offers for a partner",
                "operationId": "getOffers",
                "parameters": [
                    {
                        "name": "partnerId",
                        "in": "path",
                        "description": "Partner Id",
                        "required": true,
                        "type": "integer"
                    }
                ],
                "responses": {
                    "404": {
                        "description": "not found",
                        "schema": {
                            "$ref": "#/definitions/Error"
                        }
                    }
                }
            }
        },
        "/offer/": {
            "post": {
                "tags": [
                    "offer"
                ],
                "summary": "Create an offer, according to the subtype, the offer is an aftersale or sale offer",
                "operationId": "createOffer",
                "parameters": [
                    {
                        "name": "offer aftersale",
                        "in": "body",
                        "description": "Offer aftersale example",
                        "required": true,
                        "schema": {
                            "$ref": "#/definitions/OfferAftersale"
                        }
                    },
                    {
                        "name": "offer sale - SecondhandCar",
                        "in": "body",
                        "description": "Offer sale secondhand example",
                        "required": true,
                        "schema": {
                            "$ref": "#/definitions/OfferSecondhandCar"
                        }
                    },
                    {
                        "name": "offer sale - NewCar",
                        "in": "body",
                        "description": "Offer sale newcar example",
                        "required": true,
                        "schema": {
                            "$ref": "#/definitions/OfferNewCar"
                        }
                    }
                ],
                "responses": {
                    "201": {
                        "description": "offer created",
                        "schema": {
                            "$ref": "#/definitions/OfferAftersaleComplete"
                        }
                    },
                    "404": {
                        "description": "not found",
                        "schema": {
                            "$ref": "#/definitions/Error"
                        }
                    },
                    "500": {
                        "description": "Bad Subtype or Invalid terms",
                        "schema": {
                            "$ref": "#/definitions/Error"
                        }
                    }
                }
            },
            "patch": {
                "tags": [
                    "offer"
                ],
                "summary": "Update an offer",
                "operationId": "updateOffer",
                "parameters": [
                    {
                        "name": "offer",
                        "in": "body",
                        "description": "Offer",
                        "required": true,
                        "schema": {
                            "$ref": "#/definitions/OfferUpdate"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "offer updated - Example for sale",
                        "schema": {
                            "$ref": "#/definitions/OfferSaleComplete"
                        }
                    },
                    "404": {
                        "description": "not found",
                        "schema": {
                            "$ref": "#/definitions/Error"
                        }
                    },
                    "500": {
                        "description": "Bad Subtype or Invalid offer",
                        "schema": {
                            "$ref": "#/definitions/Error"
                        }
                    }
                }
            }
        },
        "/offer/subtype/{typeId}": {
            "get": {
                "tags": [
                    "subtype"
                ],
                "summary": "Get Subtypes",
                "operationId": "getSubtypes",
                "parameters": [
                    {
                        "name": "typeId",
                        "in": "path",
                        "description": "Type Id",
                        "required": true,
                        "type": "integer"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Get subtypes",
                        "schema": {
                            "type": "array",
                            "items": {
                                "$ref": "#/definitions/Subtype"
                            }
                        }
                    },
                    "404": {
                        "description": "not found",
                        "schema": {
                            "$ref": "#/definitions/Error"
                        }
                    }
                }
            }
        },
        "/offer/type/{category}": {
            "get": {
                "tags": [
                    "type"
                ],
                "summary": "Get Types",
                "operationId": "getTypes",
                "parameters": [
                    {
                        "name": "category",
                        "in": "path",
                        "description": "Category name : AFTERSALE, SECONDHANDCAR, NEWCAR",
                        "required": true,
                        "type": "string"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Get types",
                        "schema": {
                            "type": "array",
                            "items": {
                                "$ref": "#/definitions/Type"
                            }
                        }
                    },
                    "404": {
                        "description": "not found",
                        "schema": {
                            "$ref": "#/definitions/Error"
                        }
                    }
                }
            }
        },
        "/offer/funding": {
            "post": {
                "tags": [
                    "Offer Funding"
                ],
                "summary": "Create a funding offer.",
                "operationId": "createFundingOffer",
                "parameters": [
                    {
                        "name": "offerFunding",
                        "in": "body",
                        "description": "Funding offer example",
                        "required": true,
                        "schema": {
                            "$ref": "#/definitions/OfferFunding"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "offer created",
                        "schema": {
                            "$ref": "#/definitions/FundingComplete"
                        }
                    },
                    "404": {
                        "description": "not found",
                        "schema": {
                            "$ref": "#/definitions/Error"
                        }
                    }
                }
            }
        }
    },
    "definitions": {
        "Context": {
            "properties": {
                "context": {
                    "type": "string"
                }
            },
            "type": "object"
        },
        "Success": {
            "properties": {
                "data": {
                    "properties": {
                        "message": {
                            "type": "string"
                        }
                    },
                    "type": "object"
                }
            },
            "type": "object",
            "allOf": [
                {
                    "$ref": "#/definitions/Context"
                }
            ]
        },
        "Error": {
            "required": [
                "errors"
            ],
            "properties": {
                "errors": {
                    "type": "array",
                    "items": {
                        "properties": {
                            "message": {
                                "type": "string"
                            },
                            "code": {
                                "type": "integer"
                            },
                            "type": {
                                "type": "string"
                            }
                        }
                    }
                }
            },
            "type": "object",
            "allOf": [
                {
                    "$ref": "#/definitions/Context"
                }
            ]
        },
        "Id": {
            "required": [
                "id"
            ],
            "properties": {
                "id": {
                    "type": "integer"
                }
            }
        },
        "TimestampableEntity": {
            "properties": {
                "createdAt": {
                    "type": "string",
                    "format": "date-time",
                    "default": "now"
                },
                "updatedAt": {
                    "type": "string",
                    "format": "date-time",
                    "default": "now"
                }
            }
        },
        "TimestampableOfferEntity": {
            "required": [
                "startDate",
                "endDate"
            ],
            "properties": {
                "startDate": {
                    "type": "string",
                    "format": "y-m-d"
                },
                "endDate": {
                    "type": "string",
                    "format": "y-m-d"
                }
            }
        },
        "Description": {
            "required": [
                "description"
            ],
            "properties": {
                "description": {
                    "type": "string"
                }
            }
        },
        "Terms": {
            "required": [
                "terms"
            ],
            "properties": {
                "terms": {
                    "type": "string"
                }
            }
        },
        "OfferBaseAttributes": {
            "required": [
                "agreements",
                "title",
                "visual",
                "subtype",
                "partner"
            ],
            "properties": {
                "agreements": {
                    "description": "1 or 0",
                    "type": "integer"
                },
                "title": {
                    "type": "string"
                },
                "visual": {
                    "description": "visual name",
                    "type": "string"
                },
                "subtype": {
                    "description": "subtype id",
                    "type": "integer"
                },
                "partner": {
                    "description": "partner id",
                    "type": "integer"
                }
            }
        },
        "OfferBaseCompleteAttributes": {
            "required": [
                "agreements",
                "title",
                "visual",
                "subtype",
                "partner"
            ],
            "properties": {
                "agreements": {
                    "description": "1 or 0",
                    "type": "integer"
                },
                "title": {
                    "type": "string"
                },
                "visual": {
                    "description": "visual name",
                    "type": "string"
                },
                "partner": {
                    "description": "partner id",
                    "type": "integer"
                },
                "subtype": {
                    "type": "object",
                    "allOf": [
                        {
                            "$ref": "#definitions/Subtype"
                        }
                    ]
                }
            }
        },
        "OfferAftersaleAttributes": {
            "required": [
                "details"
            ],
            "properties": {
                "details": {
                    "type": "string"
                },
                "discountSimple": {
                    "description": "required according to the subtype, float",
                    "type": "string"
                },
                "discountDouble": {
                    "description": "required according to the subtype, float",
                    "type": "string"
                },
                "discountTriple": {
                    "description": "required according to the subtype, float",
                    "type": "string"
                }
            }
        },
        "OfferAftersaleTerms": {
            "properties": {
                "km": {
                    "type": "integer"
                }
            }
        },
        "OfferSaleAttributes": {
            "required": [
                "monthly",
                "model",
                "xPosition",
                "yPosition"
            ],
            "properties": {
                "monthly": {
                    "type": "string"
                },
                "model": {
                    "description": "model id of the vehicle",
                    "type": "integer"
                },
                "xPosition": {
                    "description": "the abscissa of the div block that contains prices",
                    "type": "string"
                },
                "yPosition": {
                    "description": "the ordinate of the div block that contains prices",
                    "type": "string"
                }
            }
        },
        "OfferSecondhandCarTerms": {
            "properties": {
                "modelName": {
                    "type": "string"
                },
                "engine": {
                    "type": "string"
                },
                "email": {
                    "type": "string"
                },
                "address": {
                    "type": "string"
                }
            }
        },
        "OfferNewCarTerms": {
            "properties": {
                "monthNumber": {
                    "type": "integer"
                },
                "advancePayment": {
                    "description": "float",
                    "type": "string"
                },
                "monthRentalNumber": {
                    "type": "integer"
                },
                "monthly": {
                    "description": "float",
                    "type": "string"
                },
                "priceDate": {
                    "type": "string",
                    "format": "y-m-d"
                },
                "modelName": {
                    "type": "string"
                },
                "engine": {
                    "type": "string"
                },
                "options": {
                    "type": "string"
                },
                "rangeName": {
                    "type": "string"
                },
                "mgpMin": {
                    "description": "float",
                    "type": "string"
                },
                "mgpMax": {
                    "description": "float",
                    "type": "string"
                },
                "co2EmissionMin": {
                    "description": "float",
                    "type": "string"
                },
                "co2EmissionMax": {
                    "description": "float",
                    "type": "string"
                },
                "maximumKm": {
                    "type": "integer"
                },
                "partner": {
                    "type": "string"
                }
            }
        },
        "OfferAftersale": {
            "properties": {
                "offer": {
                    "type": "object",
                    "allOf": [
                        {
                            "$ref": "#definitions/TimestampableOfferEntity"
                        },
                        {
                            "$ref": "#definitions/OfferBaseAttributes"
                        },
                        {
                            "$ref": "#definitions/Description"
                        },
                        {
                            "$ref": "#definitions/Terms"
                        },
                        {
                            "$ref": "#definitions/OfferAftersaleAttributes"
                        }
                    ]
                },
                "terms": {
                    "type": "object",
                    "allOf": [
                        {
                            "$ref": "#definitions/OfferAftersaleTerms"
                        }
                    ]
                }
            }
        },
        "OfferSale": {
            "properties": {
                "offer": {
                    "type": "object",
                    "allOf": [
                        {
                            "$ref": "#definitions/TimestampableOfferEntity"
                        },
                        {
                            "$ref": "#definitions/OfferBaseAttributes"
                        },
                        {
                            "$ref": "#definitions/Description"
                        },
                        {
                            "$ref": "#definitions/Terms"
                        },
                        {
                            "$ref": "#definitions/OfferSaleAttributes"
                        }
                    ]
                }
            }
        },
        "OfferSecondhandCar": {
            "properties": {
                "terms": {
                    "type": "object",
                    "allOf": [
                        {
                            "$ref": "#definitions/OfferSecondhandCarTerms"
                        }
                    ]
                }
            },
            "allOf": [
                {
                    "$ref": "#definitions/OfferSale"
                }
            ]
        },
        "OfferNewCar": {
            "properties": {
                "terms": {
                    "type": "object",
                    "allOf": [
                        {
                            "$ref": "#definitions/OfferNewCarTerms"
                        }
                    ]
                }
            },
            "allOf": [
                {
                    "$ref": "#definitions/OfferSale"
                }
            ]
        },
        "OfferAftersaleComplete": {
            "properties": {
                "status": {
                    "type": "integer",
                    "default": "1"
                }
            },
            "allOf": [
                {
                    "$ref": "#definitions/Id"
                },
                {
                    "$ref": "#definitions/TimestampableEntity"
                },
                {
                    "$ref": "#definitions/TimestampableOfferEntity"
                },
                {
                    "$ref": "#definitions/OfferBaseCompleteAttributes"
                },
                {
                    "$ref": "#definitions/Description"
                },
                {
                    "$ref": "#definitions/Terms"
                },
                {
                    "$ref": "#definitions/OfferAftersaleAttributes"
                }
            ]
        },
        "OfferUpdate": {
            "properties": {
                "subtype": {
                    "description": "subtype id",
                    "type": "integer"
                },
                "endDate": {
                    "type": "string",
                    "format": "y-m-d"
                },
                "visual": {
                    "type": "string"
                }
            },
            "allOf": [
                {
                    "$ref": "#definitions/Id"
                },
                {
                    "$ref": "#definitions/Description"
                }
            ]
        },
        "OfferSaleComplete": {
            "properties": {
                "status": {
                    "type": "integer",
                    "default": "1"
                }
            },
            "allOf": [
                {
                    "$ref": "#definitions/Id"
                },
                {
                    "$ref": "#definitions/TimestampableEntity"
                },
                {
                    "$ref": "#definitions/TimestampableOfferEntity"
                },
                {
                    "$ref": "#definitions/OfferBaseCompleteAttributes"
                },
                {
                    "$ref": "#definitions/Description"
                },
                {
                    "$ref": "#definitions/Terms"
                },
                {
                    "$ref": "#definitions/OfferSaleAttributes"
                }
            ]
        },
        "Name": {
            "properties": {
                "name": {
                    "type": "string"
                }
            }
        },
        "Type": {
            "properties": {
                "category": {
                    "type": "string"
                },
                "subtitle": {
                    "type": "string"
                }
            },
            "allOf": [
                {
                    "$ref": "#definitions/Id"
                },
                {
                    "$ref": "#definitions/Name"
                }
            ]
        },
        "FormType": {
            "properties": {
                "type": {
                    "type": "string"
                }
            },
            "allOf": [
                {
                    "$ref": "#definitions/Id"
                },
                {
                    "$ref": "#definitions/Description"
                },
                {
                    "$ref": "#definitions/Name"
                }
            ]
        },
        "Subtype": {
            "properties": {
                "rank": {
                    "type": "string"
                },
                "type": {
                    "type": "object",
                    "allOf": [
                        {
                            "$ref": "#definitions/Type"
                        }
                    ]
                },
                "formType": {
                    "type": "object",
                    "allOf": [
                        {
                            "$ref": "#definitions/FormType"
                        }
                    ]
                }
            },
            "allOf": [
                {
                    "$ref": "#definitions/Id"
                },
                {
                    "$ref": "#definitions/Terms"
                },
                {
                    "$ref": "#definitions/Name"
                }
            ]
        },
        "FundingAttributes": {
            "required": [
                "type",
                "modelId",
                "rangeId",
                "price",
                "withContribution",
                "guaranteed",
                "maintained",
                "details",
                "legalNotice",
                "visual",
                "active"
            ],
            "properties": {
                "allOf": [
                    {
                        "$ref": "#definitions/TimestampableOfferEntity"
                    }
                ],
                "type": {
                    "description": "NATIONAL or LOCAL",
                    "type": "string",
                    "default": "NATIONAL"
                },
                "label": {
                    "description": "Label",
                    "type": "string"
                },
                "modelId": {
                    "description": "Model ID",
                    "type": "string"
                },
                "rangeId": {
                    "description": "Range ID",
                    "type": "integer"
                },
                "price": {
                    "description": "Price",
                    "type": "integer"
                },
                "withContribution": {
                    "description": "With Contribution",
                    "type": "integer"
                },
                "guaranteed": {
                    "description": "Guaranteed for 3 years ?",
                    "type": "integer"
                },
                "maintained": {
                    "description": "Include maintain pack ?",
                    "type": "integer"
                },
                "details": {
                    "description": "Details",
                    "type": "string"
                },
                "legalNotice": {
                    "description": "Legal notice",
                    "type": "string"
                },
                "visual": {
                    "description": "Visual Name",
                    "type": "string"
                },
                "active": {
                    "description": "Is offer active ?",
                    "type": "integer"
                }
            }
        },
        "OfferFunding": {
            "properties": {
                "funding": {
                    "type": "object",
                    "allOf": [
                        {
                            "$ref": "#definitions/FundingAttributes"
                        }
                    ]
                }
            }
        },
        "FundingComplete": {
            "properties": {
                "active": {
                    "type": "boolean"
                }
            },
            "allOf": [
                {
                    "$ref": "#definitions/FundingAttributes"
                }
            ]
        }
    }
}